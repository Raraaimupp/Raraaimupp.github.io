<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
  <meta name="theme-color" content="#07060b"/>
  <title>Premium Chat Panel</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --bg:#07060b;
      --card: rgba(18, 12, 20, .70);
      --card2: rgba(8, 6, 12, .72);
      --stroke: rgba(255, 55, 120, .18);
      --stroke2: rgba(255,255,255,.08);
      --text:#ffeaf2;
      --muted: rgba(255,234,242,.58);
      --muted2: rgba(255,234,242,.38);

      --red:#ff2b6a;
      --red2:#ff4d8b;
      --pink:#ff68d4;
      --good:#22c55e;
      --warn:#facc15;
      --bad:#fb7185;

      --fontH: 'Orbitron', sans-serif;
      --fontB: 'Share Tech Mono', monospace;

      --r16:16px;
      --r20:20px;
      --shadow: 0 22px 80px rgba(0,0,0,.60);
    }

    *{box-sizing:border-box;margin:0;padding:0;font-family:var(--fontB);-webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{
      background:
        radial-gradient(1000px 700px at 20% 10%, rgba(255,43,106,.14), transparent 55%),
        radial-gradient(800px 800px at 85% 15%, rgba(255,104,212,.10), transparent 55%),
        radial-gradient(900px 700px at 50% 90%, rgba(255,77,139,.10), transparent 60%),
        linear-gradient(180deg, #04030a, #07060b 40%, #04030a);
      color:var(--text);
      overflow:hidden;
    }

    /* subtle scanline */
    body:before{
      content:"";
      position:fixed;inset:0;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.03),
        rgba(255,255,255,.03) 1px,
        transparent 1px,
        transparent 5px
      );
      opacity:.12;
      pointer-events:none;
      mix-blend-mode: overlay;
      z-index:0;
    }

    /* floating glow blobs */
    .blob{
      position:fixed; inset:auto;
      width:380px; height:380px;
      border-radius:50%;
      filter: blur(28px);
      opacity:.22;
      z-index:0;
      animation: drift 10s ease-in-out infinite;
    }
    .b1{ left:-120px; top:-140px; background: radial-gradient(circle, rgba(255,43,106,.9), transparent 60%); }
    .b2{ right:-140px; top:90px; background: radial-gradient(circle, rgba(255,104,212,.9), transparent 60%); animation-duration: 12s; }
    .b3{ left:18%; bottom:-170px; background: radial-gradient(circle, rgba(255,77,139,.9), transparent 60%); animation-duration: 14s; }
    @keyframes drift{
      0%,100%{ transform: translate(0,0) scale(1); }
      50%{ transform: translate(30px, -18px) scale(1.05); }
    }

    .wrap{
      position:relative;
      z-index:1;
      height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    .panel{
      width:min(980px, 96vw);
      border-radius:24px;
      border:1px solid var(--stroke2);
      background: linear-gradient(180deg, rgba(18, 12, 20, .86), rgba(8, 6, 12, .62));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .panel:before{
      content:"";
      position:absolute; inset:-2px;
      background: conic-gradient(from 180deg,
        rgba(255,43,106,.18),
        rgba(255,104,212,.16),
        rgba(255,77,139,.16),
        rgba(255,43,106,.18)
      );
      filter: blur(20px);
      opacity:.75;
      animation: hue 8s linear infinite;
      z-index:-1;
    }
    @keyframes hue{
      0%{ filter:hue-rotate(0deg) blur(20px); }
      100%{ filter:hue-rotate(360deg) blur(20px); }
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.06));
      backdrop-filter: blur(10px);
    }
    .brand{
      display:flex; align-items:center; gap:10px; min-width:0;
    }
    .logo{
      width:40px;height:40px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: radial-gradient(circle at 30% 30%, rgba(255,104,212,.25), transparent 55%),
                  radial-gradient(circle at 75% 75%, rgba(255,43,106,.28), transparent 55%),
                  rgba(0,0,0,.22);
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      display:flex;align-items:center;justify-content:center;
      position:relative;
      overflow:hidden;
    }
    .logo:after{
      content:"";
      position:absolute; inset:-40%;
      background: conic-gradient(from 180deg, transparent, rgba(255,43,106,.35), transparent, rgba(255,104,212,.30), transparent);
      animation: spin 6s linear infinite;
      filter: blur(10px);
      opacity:.8;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }
    .logo span{
      position:relative;
      z-index:1;
      font-family:var(--fontH);
      letter-spacing:2px;
      font-weight:800;
      font-size:12px;
      color: rgba(255,234,242,.95);
      text-shadow: 0 0 18px rgba(255,43,106,.25);
    }
    .brand h1{
      font-family:var(--fontH);
      letter-spacing:3px;
      text-transform:uppercase;
      font-size:14px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color: rgba(255,234,242,.86);
      font-family:var(--fontH);
      letter-spacing:2px;
      font-size:10px;
      text-transform:uppercase;
      white-space:nowrap;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;
      background: rgba(255,255,255,.25);
      box-shadow: 0 0 14px rgba(255,43,106,.18);
    }
    .dot.on{ background: var(--good); box-shadow: 0 0 16px rgba(34,197,94,.25); }

    .content{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:0;
      min-height: 520px;
    }

    .left{
      padding:18px;
      border-right:1px solid rgba(255,255,255,.08);
      background:
        radial-gradient(900px 400px at 0% 0%, rgba(255,43,106,.10), transparent 55%),
        radial-gradient(900px 500px at 100% 100%, rgba(255,104,212,.08), transparent 55%),
        rgba(0,0,0,.10);
    }

    .hero{
      border:1px solid rgba(255,255,255,.10);
      border-radius:20px;
      padding:18px;
      background: linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.08));
      position:relative;
      overflow:hidden;
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
    }
    .hero:before{
      content:"";
      position:absolute; inset:-2px;
      background: linear-gradient(135deg, rgba(255,43,106,.20), rgba(255,104,212,.16), rgba(255,77,139,.18));
      filter: blur(16px);
      opacity:.55;
      z-index:-1;
      animation: hue 10s linear infinite;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,43,106,.30);
      background: rgba(0,0,0,.22);
      box-shadow: 0 0 0 1px rgba(255,43,106,.08) inset;
      color: rgba(255,234,242,.92);
      margin-bottom:12px;
      font-family:var(--fontH);
      letter-spacing:2px;
      font-size:10px;
      text-transform:uppercase;
    }
    .badge .ring{
      width:9px;height:9px;border-radius:999px;
      background: var(--red);
      box-shadow: 0 0 16px rgba(255,43,106,.35);
      animation: pulse 1.2s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform: scale(.9); opacity:.9; }
      50%{ transform: scale(1.2); opacity:1; }
    }

    .hero h2{
      font-family:var(--fontH);
      letter-spacing:3px;
      text-transform:uppercase;
      font-size:18px;
      line-height:1.3;
    }
    .hero p{
      margin-top:10px;
      color: var(--muted);
      font-size:12px;
      line-height:1.7;
      max-width: 62ch;
    }

    .statusbox{
      margin-top:14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .sbox{
      flex:1;
      min-width: 190px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding:12px 12px;
    }
    .sbox .t1{
      font-family:var(--fontH);
      letter-spacing:2px;
      font-size:10px;
      text-transform:uppercase;
      color: var(--muted2);
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }
    .sbox .t2{
      margin-top:8px;
      font-family:var(--fontH);
      letter-spacing:2px;
      font-size:12px;
      text-transform:uppercase;
      color: rgba(255,234,242,.92);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .right{
      padding:18px;
      background: linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.06));
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .card{
      border:1px solid rgba(255,255,255,.10);
      border-radius:20px;
      background: rgba(0,0,0,.18);
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .cardhead{
      padding:14px 14px 12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .cardhead .title{
      font-family:var(--fontH);
      letter-spacing:3px;
      text-transform:uppercase;
      font-size:12px;
    }
    .tag{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      color: var(--muted);
      font-family:var(--fontH);
      letter-spacing:2px;
      font-size:9px;
      text-transform:uppercase;
      white-space:nowrap;
    }

    .cardbody{ padding:14px; display:flex; flex-direction:column; gap:10px; }

    label{
      color: var(--muted2);
      font-size:11px;
      letter-spacing:1px;
      text-transform:uppercase;
    }
    .field{
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.30);
      color: var(--text);
      outline:none;
      font-size:14px;
      transition: border-color .15s ease, background .15s ease;
    }
    .field:focus{
      border-color: rgba(255,43,106,.28);
      box-shadow: 0 0 0 3px rgba(255,43,106,.08);
      background: rgba(0,0,0,.38);
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .btn{
      flex:1;
      min-width: 150px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(135deg, rgba(255,43,106,.18), rgba(255,104,212,.12), rgba(255,77,139,.14));
      color: rgba(255,234,242,.95);
      cursor:pointer;
      font-family:var(--fontH);
      letter-spacing:3px;
      text-transform:uppercase;
      font-size:11px;
      transition: transform .15s ease, filter .15s ease, border-color .15s ease;
      position:relative;
      overflow:hidden;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.06); border-color: rgba(255,43,106,.22); }
    .btn.secondary{
      background: rgba(0,0,0,.22);
      letter-spacing:2px;
    }
    .btn.danger{
      background: linear-gradient(135deg, rgba(251,113,133,.18), rgba(255,43,106,.12));
      border-color: rgba(251,113,133,.25);
    }

    .hint{
      color: var(--muted);
      font-size:12px;
      line-height:1.6;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      z-index:99;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.72);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      width: min(560px, 92vw);
      display:none;
    }
    .toast.on{ display:block; animation: pop .18s ease; }
    @keyframes pop{ from{ transform:translateX(-50%) translateY(10px); opacity:0; } to{ transform:translateX(-50%) translateY(0); opacity:1; } }
    .toast .t1{ font-family:var(--fontH); letter-spacing:2px; text-transform:uppercase; font-size:10px; color: var(--muted2); }
    .toast .t2{ margin-top:6px; font-size:13px; color: rgba(255,234,242,.95); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    /* modal */
    .modal{
      position:fixed; inset:0;
      z-index:90;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      background: rgba(0,0,0,.70);
      backdrop-filter: blur(10px);
    }
    .modal.on{ display:flex; }
    .modal .mcard{
      width: min(560px, 96vw);
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(18,12,20,.88), rgba(0,0,0,.60));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .mhead{
      padding:14px 14px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }
    .mhead .mt{
      font-family:var(--fontH);
      letter-spacing:3px;
      text-transform:uppercase;
      font-size:12px;
    }
    .xbtn{
      width:44px;height:44px;border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      color: rgba(255,234,242,.95);
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-family:var(--fontH);
      letter-spacing:2px;
    }
    .mbody{ padding:14px; display:flex; flex-direction:column; gap:10px; }

    /* responsive */
    @media (max-width: 880px){
      .content{ grid-template-columns: 1fr; }
      .left{ border-right:none; border-bottom:1px solid rgba(255,255,255,.08); }
      .hero h2{ font-size:16px; }
    }
  </style>
</head>
<body>
  <div class="blob b1"></div>
  <div class="blob b2"></div>
  <div class="blob b3"></div>

  <div class="wrap">
    <div class="panel">
      <div class="topbar">
        <div class="brand">
          <div class="logo"><span>AI</span></div>
          <h1>Premium Control Panel</h1>
        </div>
        <div class="pill"><span class="dot" id="dot"></span><span id="who">GUEST</span></div>
      </div>

      <div class="content">
        <div class="left">
          <div class="hero">
            <div class="badge"><span class="ring"></span> Premium Access</div>
            <h2>Welcome To Secure Chat Panel</h2>
            <p>
              Login dulu untuk masuk dashboard. <br/>
              Fitur <b>Create Account</b> hanya bisa dipakai oleh <b>akun utama</b>.
            </p>

            <div class="statusbox">
              <div class="sbox">
                <div class="t1"><span>Role</span><span class="tag" id="roleTag">GUEST</span></div>
                <div class="t2" id="roleText">NOT LOGGED IN</div>
              </div>
              <div class="sbox">
                <div class="t1"><span>Storage</span><span class="tag">Local</span></div>
                <div class="t2" id="dbStat">ACCOUNTS: 0</div>
              </div>
            </div>
          </div>

          <div style="margin-top:12px" class="hint">
            • Admin login: <b>raraaimupp</b> / <b>22</b> <br/>
            • Akun user yang dibuat akan tersimpan di browser ini.
          </div>
        </div>

        <div class="right">
          <div class="card">
            <div class="cardhead">
              <div class="title">Login</div>
              <div class="tag">Access</div>
            </div>
            <div class="cardbody">
              <div>
                <label>Username</label>
                <input class="field" id="loginUser" autocomplete="off" placeholder="username...">
              </div>
              <div>
                <label>Password</label>
                <input class="field" id="loginPass" type="password" placeholder="password...">
              </div>

              <div class="row">
                <button class="btn" id="btnLogin">LOGIN</button>
                <button class="btn secondary" id="btnLogout" disabled>LOGOUT</button>
              </div>

              <div class="row">
                <button class="btn" id="btnOpenCreate" disabled>CREATE ACCOUNT</button>
                <button class="btn danger" id="btnReset">RESET DATA</button>
              </div>

              <div class="hint" id="hintBox">
                Login dulu. Jika kamu admin, tombol Create Account akan aktif.
              </div>
            </div>
          </div>

          <div class="card">
            <div class="cardhead">
              <div class="title">Dashboard</div>
              <div class="tag" id="dashTag">Locked</div>
            </div>
            <div class="cardbody">
              <div class="hint" id="dashText">
                Setelah login, kamu bisa diarahkan ke halaman chat kamu sendiri.
                (Saat ini demo panel).
              </div>
              <div class="row">
                <button class="btn secondary" id="btnGoChat" disabled>ENTER CHAT</button>
              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>

  <!-- Create Account Modal -->
  <div class="modal" id="modal">
    <div class="mcard">
      <div class="mhead">
        <div class="mt">Create Account</div>
        <button class="xbtn" id="closeModal">X</button>
      </div>
      <div class="mbody">
        <div class="hint">
          Hanya admin (<b>raraaimupp</b>) yang boleh membuat akun baru.
        </div>
        <div>
          <label>New Username</label>
          <input class="field" id="newUser" autocomplete="off" placeholder="contoh: user123">
        </div>
        <div>
          <label>New Password</label>
          <input class="field" id="newPass" type="password" placeholder="password user">
        </div>
        <div class="row">
          <button class="btn" id="btnCreate">CREATE</button>
          <button class="btn secondary" id="btnCancel">CANCEL</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <div class="t1" id="tTitle">INFO</div>
    <div class="t2" id="tMsg">...</div>
  </div>

  <script>
    /* ===========================================================
      CONFIG (ADMIN ONLY)
    =========================================================== */
    const ADMIN_USER = "raraaimupp";
    const ADMIN_PASS = "22";

    /* ===========================================================
      STORAGE
    =========================================================== */
    const KEY_DB = "premium_accounts_db_v1";
    const KEY_SESSION = "premium_session_v1";

    function loadDB(){
      try{
        const raw = localStorage.getItem(KEY_DB);
        const db = raw ? JSON.parse(raw) : { users: {} };
        if(!db.users) db.users = {};
        return db;
      }catch{
        return { users: {} };
      }
    }
    function saveDB(db){
      localStorage.setItem(KEY_DB, JSON.stringify(db));
    }

    function setSession(user){
      localStorage.setItem(KEY_SESSION, JSON.stringify({ user, ts: Date.now() }));
    }
    function getSession(){
      try{
        const s = localStorage.getItem(KEY_SESSION);
        return s ? JSON.parse(s) : null;
      }catch{ return null; }
    }
    function clearSession(){
      localStorage.removeItem(KEY_SESSION);
    }

    /* ===========================================================
      UI
    =========================================================== */
    const el = {
      dot: document.getElementById("dot"),
      who: document.getElementById("who"),
      roleTag: document.getElementById("roleTag"),
      roleText: document.getElementById("roleText"),
      dbStat: document.getElementById("dbStat"),

      loginUser: document.getElementById("loginUser"),
      loginPass: document.getElementById("loginPass"),
      btnLogin: document.getElementById("btnLogin"),
      btnLogout: document.getElementById("btnLogout"),
      btnOpenCreate: document.getElementById("btnOpenCreate"),
      btnReset: document.getElementById("btnReset"),

      hintBox: document.getElementById("hintBox"),

      dashTag: document.getElementById("dashTag"),
      dashText: document.getElementById("dashText"),
      btnGoChat: document.getElementById("btnGoChat"),

      modal: document.getElementById("modal"),
      closeModal: document.getElementById("closeModal"),
      btnCancel: document.getElementById("btnCancel"),
      newUser: document.getElementById("newUser"),
      newPass: document.getElementById("newPass"),
      btnCreate: document.getElementById("btnCreate"),

      toast: document.getElementById("toast"),
      tTitle: document.getElementById("tTitle"),
      tMsg: document.getElementById("tMsg")
    };

    const esc = (s)=> String(s ?? "").replace(/[<>&"]/g, c => ({'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'}[c]));
    function toast(title, msg){
      el.tTitle.textContent = String(title||"INFO").toUpperCase();
      el.tMsg.textContent = String(msg||"");
      el.toast.classList.add("on");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> el.toast.classList.remove("on"), 2600);
    }

    let currentUser = null;

    function isAdmin(){
      return currentUser === ADMIN_USER;
    }

    function refreshUI(){
      const db = loadDB();
      const total = Object.keys(db.users || {}).length;
      el.dbStat.textContent = "ACCOUNTS: " + total;

      if(!currentUser){
        el.dot.classList.remove("on");
        el.who.textContent = "GUEST";
        el.roleTag.textContent = "GUEST";
        el.roleText.textContent = "NOT LOGGED IN";
        el.hintBox.innerHTML = "Login dulu. Jika kamu admin, tombol <b>Create Account</b> akan aktif.";
        el.btnLogout.disabled = true;
        el.btnOpenCreate.disabled = true;
        el.btnGoChat.disabled = true;
        el.dashTag.textContent = "Locked";
        el.dashText.innerHTML = "Dashboard terkunci. Login untuk masuk.";
        return;
      }

      el.dot.classList.add("on");
      el.who.textContent = currentUser.toUpperCase();

      if(isAdmin()){
        el.roleTag.textContent = "ADMIN";
        el.roleText.textContent = "FULL CONTROL";
        el.hintBox.innerHTML = "Kamu login sebagai <b>ADMIN</b>. Kamu bisa buat akun user.";
        el.btnOpenCreate.disabled = false;
      }else{
        el.roleTag.textContent = "USER";
        el.roleText.textContent = "STANDARD ACCESS";
        el.hintBox.innerHTML = "Kamu login sebagai <b>USER</b>. Create Account dikunci.";
        el.btnOpenCreate.disabled = true;
      }

      el.btnLogout.disabled = false;
      el.btnGoChat.disabled = false;
      el.dashTag.textContent = "Open";
      el.dashText.innerHTML = "Akses terbuka. Tombol ENTER CHAT bisa diarahkan ke halaman chat kamu.";
    }

    function openModal(){
      el.modal.classList.add("on");
      el.newUser.value = "";
      el.newPass.value = "";
      setTimeout(()=> el.newUser.focus(), 50);
    }
    function closeModal(){
      el.modal.classList.remove("on");
    }

    /* ===========================================================
      AUTH
    =========================================================== */
    function login(username, password){
      const u = String(username||"").trim();
      const p = String(password||"").trim();
      if(!u || !p) return toast("LOGIN", "Username & password wajib diisi.");

      // admin check (hard-coded)
      if(u === ADMIN_USER && p === ADMIN_PASS){
        currentUser = ADMIN_USER;
        setSession(currentUser);
        toast("LOGIN", "Admin login sukses.");
        refreshUI();
        return;
      }

      // normal users check from local DB
      const db = loadDB();
      const stored = db.users?.[u];
      if(!stored) return toast("LOGIN", "Akun tidak ditemukan. Minta admin buatkan akun.");
      if(stored.pass !== p) return toast("LOGIN", "Password salah.");

      currentUser = u;
      setSession(currentUser);
      toast("LOGIN", "Login sukses. Selamat datang!");
      refreshUI();
    }

    function logout(){
      currentUser = null;
      clearSession();
      toast("LOGOUT", "Kamu sudah logout.");
      refreshUI();
    }

    function createAccount(newUser, newPass){
      if(!isAdmin()) return toast("DENIED", "Hanya admin yang bisa create akun.");
      const u = String(newUser||"").trim();
      const p = String(newPass||"").trim();

      if(u.length < 3) return toast("CREATE", "Username minimal 3 karakter.");
      if(p.length < 2) return toast("CREATE", "Password minimal 2 karakter.");
      if(u === ADMIN_USER) return toast("CREATE", "Username ini reserved admin.");

      const db = loadDB();
      if(db.users?.[u]) return toast("CREATE", "Username sudah dipakai.");

      db.users[u] = { pass: p, createdAt: Date.now() };
      saveDB(db);

      toast("CREATE", "Akun berhasil dibuat: " + u);
      closeModal();
      refreshUI();
    }

    function resetData(){
      // reset DB only (not removing admin)
      localStorage.removeItem(KEY_DB);
      toast("RESET", "Data akun user dihapus (admin tetap ada).");
      refreshUI();
    }

    /* ===========================================================
      INIT + EVENTS
    =========================================================== */
    function init(){
      // restore session
      const sess = getSession();
      if(sess?.user){
        currentUser = sess.user;
      }

      refreshUI();

      el.btnLogin.addEventListener("click", ()=>{
        login(el.loginUser.value, el.loginPass.value);
      });
      el.loginPass.addEventListener("keydown", (e)=>{
        if(e.key === "Enter") el.btnLogin.click();
      });

      el.btnLogout.addEventListener("click", logout);

      el.btnOpenCreate.addEventListener("click", ()=>{
        if(!isAdmin()) return toast("DENIED", "Hanya admin yang bisa create akun.");
        openModal();
      });

      el.btnReset.addEventListener("click", ()=>{
        if(confirm("Hapus semua akun user yang tersimpan di browser ini?")){
          resetData();
        }
      });

      el.btnGoChat.addEventListener("click", ()=>{
        if(!currentUser) return toast("LOCKED", "Login dulu.");
        // Di sini kamu bisa redirect ke chat HTML kamu:
        // location.href = "chat.html";
        toast("ENTER", "Arahkan tombol ini ke halaman chat kamu (chat.html).");
      });

      // modal
      el.closeModal.addEventListener("click", closeModal);
      el.btnCancel.addEventListener("click", closeModal);
      el.modal.addEventListener("click", (e)=>{ if(e.target === el.modal) closeModal(); });

      el.btnCreate.addEventListener("click", ()=>{
        createAccount(el.newUser.value, el.newPass.value);
      });
      el.newPass.addEventListener("keydown", (e)=>{
        if(e.key === "Enter") el.btnCreate.click();
      });
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
